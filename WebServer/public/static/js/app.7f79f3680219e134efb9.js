webpackJsonp([1],{"1/oy":function(e,t){},"9M+g":function(e,t){},C9st:function(e,t){},Id91:function(e,t){},Jmt5:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("Jmt5"),n("9M+g");var s=n("7+uW"),o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=n("VU/8")({name:"App"},o,!1,function(e){n("jlzU")},null,null).exports,a=n("/ocq"),c={name:"Login",data:function(){return{msg:"This is Login page",email:"",password:""}},methods:{login:function(){console.log(this.email),console.log(this.password),this.$store.dispatch("user/login",{email:this.email,password:this.password})},test:function(){this.$store.dispatch("rest",{})}}},r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("form",{staticClass:"navbar-form navbar-right form-inline",attrs:{id:"signin",role:"form"},on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[n("div",{staticClass:"input-group"},[e._m(0),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"form-control",attrs:{id:"email",type:"email",name:"email",value:"",placeholder:"Email Address"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"input-group"},[e._m(1),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{id:"password",type:"password",name:"password",value:"",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e._v(" "),n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("Login")])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"input-group-addon"},[t("i",{staticClass:"glyphicon glyphicon-user"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"input-group-addon"},[t("i",{staticClass:"glyphicon glyphicon-lock"})])}]};var l=n("VU/8")(c,r,!1,function(e){n("SOiy")},"data-v-bda8f678",null).exports,u=window.google,d={name:"google-map",props:["name"],data:function(){return{mapName:this.name+"-map",markerCoordinates:[{latitude:51.501527,longitude:-.1921837,title:"Joe1"}],map:null,bounds:null,markers:[]}},mounted:function(){var e=this;this.bounds=new u.maps.LatLngBounds;var t=document.getElementById(this.mapName);console.log(this.mapName),this.markerCoordinates[0].latitude=this.$store.getters["socket/getPosition"].latitude,this.markerCoordinates[0].longitude=this.$store.getters["socket/getPosition"].longitude;var n=this.markerCoordinates[0],s={center:new u.maps.LatLng(n.latitude,n.longitude)};this.map=new u.maps.Map(t,s),this.markerCoordinates.forEach(function(t){var n=new u.maps.LatLng(t.latitude,t.longitude),s=new u.maps.Marker({position:n,map:e.map,title:t.title});e.markers.push(s),console.log(e.markers),e.map.fitBounds(e.bounds.extend(n))})},created:function(){var e=this;this.$store.watch(function(t){return e.$store.getters["socket/getPosition"]},function(t,n){n&&(e.markerCoordinates[0].latitude=n.latitude,e.markerCoordinates[0].longitude=n.longitude,e.markers[0].setPosition(new u.maps.LatLng(n.latitude,n.longitude)),console.log(e.markerCoordinates[0]))})},methods:{findTheMarker:function(e){var t=e.getPosition();this.map.setCenter(t)}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"google-map"},[n("button",{on:{click:function(t){e.findTheMarker(e.markers[0])}}},[e._v("FindTheMarker")]),e._v(" "),n("div",{staticClass:"google-map-view",attrs:{id:e.mapName}})])},staticRenderFns:[]};var g=n("VU/8")(d,m,!1,function(e){n("wXh7")},"data-v-8c474b78",null).exports,p={name:"Device",data:function(){return{msg:"Device List",devices:[]}},created:function(){this.devices=this.$store.getters["device/getUserDevices"],console.log(this.devices)},methods:{disconnectDevice:function(e){console.log(e),this.$store.dispatch("device/disconnectTheDevice",e)},test:function(){this.$store.dispatch("rest",{})}},components:{}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"device"},[n("h1",[e._v(e._s(e.msg))]),e._v(" "),n("ul",{staticClass:"list-group align-items-center w-100 list-group-flush",attrs:{id:"example-1"}},e._l(e.devices,function(t){return n("li",{key:t.id,staticClass:"list-group-item text-left w-50"},[n("div",{staticClass:"col-lg-10 list-group"},[n("span",{staticClass:"list-group-item"},[e._v("Name: "+e._s(t.name))]),e._v(" "),n("span",{staticClass:"list-group-item"},[e._v(" Type: "+e._s(t.device_type))]),e._v(" "),n("span",{staticClass:"list-group-item"},[e._v("Code: "+e._s(t.device_code))]),e._v(" "),n("span",{staticClass:"list-group-item"},[e._v("Status: "+e._s(t.status))])]),e._v(" "),n("button",{staticClass:"col-lg-2",on:{click:function(n){e.disconnectDevice(t.uid)}}},[e._v("Reset the device")])])}))])},staticRenderFns:[]};var f=n("VU/8")(p,v,!1,function(e){n("XMyg")},"data-v-7964013c",null).exports,h=n("mtWM"),_=n.n(h).a.create({baseURL:"http://192.168.99.100:8080/RestApi",headers:{"Content-Type":"application/json",Authorization:"Bearer "}}),C={data:function(){return{heartBeatCount:4}},created:function(){var e=this;this.$options.sockets.onopen=function(t){console.log(t),e.sendObj({command:"AUTH",send_to:"ALL",device_type:"BROWSER_ADMIN",device_code:"100013",random_link_code:"ed9f87fe4b804d098db258f3e6f79574",message:""})},this.$options.sockets.onmessage=function(t){e.heartBeatCount=5,console.log(t.data);var n=JSON.parse(t.data);console.log(n),n.message.position&&e.$store.commit("socket/SET_POSITION",n.message.position),"AUTH"==n.command&&"OK"===n.message&&(e.ready(),console.log("--------------ready---------------"))}},methods:{ready:function(){var e=this;window.setInterval(function(){e.heartBeatCount?e.heartBeatCount-=1:e.heartBeat()},1e3)},sendObj:function(e){this.heartBeatCount=5,this.$socket.sendObj(e)},heartBeat:function(){this.sendObj({command:"HEARTBEAT",send_to:"",device_type:"BROWSER_ADMIN",device_code:"100013",random_link_code:"ed9f87fe4b804d098db258f3e6f79574",message:""})}}},k=n("lbHh"),b={name:"Home",mixins:[C],data:function(){return{msg:"Welcome to Home page",bShowDevices:!1}},beforeCreate:function(){console.log("Nothing gets called before me!")},created:function(){var e=this;this.getLocalToken(),this.$store.getters["user/isLoggedin"]&&this.logininToDO(),this.$store.watch(function(t){return e.$store.getters["user/isLoggedin"]},function(t,n){console.log(n),console.log(t),t&&e.logininToDO(),console.log(e.$store)})},computed:{},methods:{test:function(){this.$store.dispatch("user/rest",{}),this.$store.dispatch("device/rest",{})},logininToDO:function(){_.defaults.headers.Authorization="Bearer "+this.$store.getters["user/getToken"],this.$store.dispatch("user/getTheUserInfo"),this.$store.dispatch("device/getUserDevices")},socketTest:function(){this.$socket.sendObj({awesome:"data"})},getLocalToken:function(){var e=k.get("access_token");e&&this.$store.commit("user/addWebToken",e)}},components:{"google-map":g,login:l,device:f}},T={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home header"},[n("nav",{staticClass:"navbar navbar-light navbar-expand-md bg-faded justify-content-center  container-fluid"},[n("a",{staticClass:"brand-title navbar-brand d-flex w-50 mr-auto",attrs:{href:"/"}},[e._v("IoT-CarTracking")]),e._v(" "),e._m(0),e._v(" "),n("div",{staticClass:"navbar-collapse collapse w-200",attrs:{id:"collapsingNavbar3"}},[n("ul",{staticClass:"nav navbar-nav ml-auto w-100 justify-content-end"},[n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(t){e.bShowDevices=!e.bShowDevices}}},[e._v("Devices")])]),e._v(" "),e._m(1),e._v(" "),this.$store.getters["user/isLoggedin"]?e._e():n("li",{staticClass:"nav-item"},[n("login")],1),e._v(" "),n("li",{staticClass:"nav-item"},[n("button",{on:{click:function(t){e.test()}}},[e._v("Clean Cache data")])])])])]),e._v(" "),this.bShowDevices?n("device"):e._e(),e._v(" "),n("div",{staticClass:"map"},[n("google-map",{ref:"googleMap",attrs:{name:"example"}})],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#collapsingNavbar3"}},[t("span",{staticClass:"navbar-toggler-icon"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",{staticClass:"nav-item"},[t("a",{staticClass:"nav-link",attrs:{href:"#"}},[this._v("Logout")])])}]};var w=n("VU/8")(b,T,!1,function(e){n("vf6z")},"data-v-3ce2a658",null).exports;s.a.use(a.a);var E=new a.a({routes:[{path:"/",name:"Home",component:w},{path:"/login",name:"Login",component:l}]}),O=n("e6fC"),$=n("Rf8U"),S=n.n($),N=n("NYxO"),y={namespaced:!0,state:{userName:"",loggedInStatus:!1,authToken:"",uid:""},getters:{getToken:function(e){return e.authToken},isLoggedin:function(e){return e.loggedInStatus}},actions:{login:function(e,t){_.post("/accessToken",{grant_type:"password",client_id:"6",client_secret:"3FGAU0peIBuIjdrazcaKpb2LzypqIRwuJfjiPENN",scope:"*",username:t.email,password:t.password}).then(function(t){e.commit("addWebToken",t.data.access_token),k.set("access_token",t.data.access_token,{expires:7})}).catch(function(e){console.log(e.response)})},logout:function(e){e.commit("removeWebToken")},rest:function(e){e.commit("resetState")},setUid:function(e,t){e.commit("addUid",t)},getTheUserInfo:function(e){_.get("/userInfo").then(function(t){console.log(t),e.commit("addUid",t.data.uid)}).catch(function(e){console.log("rest"),console.log(e.response)})}},mutations:{addWebToken:function(e,t){e.authToken=t,e.loggedInStatus=!0},removeWebToken:function(e){e.authToken="",e.user.authToken=!1},resetState:function(e){e.userName="",e.loggedInStatus=!1,e.authToken="",e.uid=""},addUid:function(e,t){e.uid=t}}},D={namespaced:!0,state:{device:[]},getters:{getUserDevices:function(e){return e.device}},actions:{getUserDevices:function(e){_.get("/device/userDevices").then(function(t){console.log(t),e.commit("addDevices",t.data)}).catch(function(e){console.log("getUserDevices"),console.log(e.response)})},disconnectTheDevice:function(e,t){_.post("/device/resetDevice",{device_uid:t}).then(function(e){console.log(e.data)}).catch(function(e){console.log("disconnectTheDevice"),console.log(e.response)})},rest:function(e){e.commit("resetState")}},mutations:{addDevices:function(e,t){e.device=t},resetState:function(e){e.device=[]}}},L={namespaced:!0,state:{isConnected:!1,message:"",reconnectError:!1,latitude:"",longitude:""},getters:{getPosition:function(e){return{latitude:e.latitude,longitude:e.longitude}}},actions:{},mutations:{SOCKET_ONOPEN:function(e,t){e.socket.isConnected=!0},SOCKET_ONCLOSE:function(e,t){e.socket.isConnected=!1},SOCKET_ONERROR:function(e,t){console.error(e,t)},SOCKET_ONMESSAGE:function(e,t){console.log(t),e.message=t},SOCKET_RECONNECT:function(e,t){console.info(e,t)},SOCKET_RECONNECT_ERROR:function(e){e.socket.reconnectError=!0},SET_POSITION:function(e,t){console.log(t),e.latitude=t.latitude,e.longitude=t.longitude}}};s.a.use(N.a);var U=void 0,R=function(){return U||(U=new N.a.Store({modules:{user:y,device:D,socket:L}}))},I=n("U8jO"),x=n.n(I);s.a.config.productionTip=!1,s.a.use(x.a,"ws://192.168.99.100:8080/Socket",{format:"json",reconnection:!0,reconnectionAttempts:5,reconnectionDelay:3e3}),n("C9st"),s.a.use(S.a,_),s.a.use(O.a),new s.a({el:"#app",store:R,router:E,axios:_,components:{App:i},template:"<App/>"})},SOiy:function(e,t){},XMyg:function(e,t){},jlzU:function(e,t){},vf6z:function(e,t){},wXh7:function(e,t){},zj2Q:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.7f79f3680219e134efb9.js.map